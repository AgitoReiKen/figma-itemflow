(()=>{"use strict";var n={480:function(e,t,n){var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,o){e[o=void 0===o?n:o]=t[n]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return r(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});const a=n(154),s=i(n(154));figma.showUI(__html__),figma.ui.resize(300,330),figma.ui.onmessage=e=>{switch(e.type){case"init":s.Enable(),s.GetPluginFrame().locked=!0,figma.on("close",()=>{s.Disable(),figma.closePlugin()});break;case"set-stroke-weight":s.flowSettings.weight=parseInt(e.value,10);break;case"set-stroke-cap":null!==e.value[0]&&(s.flowSettings.strokeCap[0]=e.value[0]),null!==e.value[1]&&(s.flowSettings.strokeCap[1]=e.value[1]);break;case"set-color":var t=function(e,t){return parseFloat((parseInt(t.substr(e,2),16)/255).toPrecision(3))};s.flowSettings.color.r=t(1,e.value),s.flowSettings.color.g=t(3,e.value),s.flowSettings.color.b=t(5,e.value);break;case"set-color-opacity":s.flowSettings.color.a=e.value;break;case"set-dash-pattern":t=parseInt(e.value,10);s.flowSettings.dashPattern=[t,t];break;case"set-bezier":s.flowSettings.bezier=e.value;break;case"set-enabled":e.value?s.EnableFlowEvents():s.DisableFlowEvents();break;case"set-update":e.value?s.EnableFlowUpdate():s.DisableFlowUpdate();break;case"set-framelocked":(0,a.GetPluginFrame)().locked=e.value}}},154:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.DisableFlowUpdate=t.EnableFlowUpdate=t.DisableFlowEvents=t.EnableFlowEvents=t.CreateFlow=t.Disable=t.Enable=t.GetPluginFrame=t.FlowWorker=t.flowSettings=t.FlowSettings=void 0;const r=n(522),g=o(n(634)),v=o(n(464)),i="ItemFrame",s="IF",m="IFC",l="IFS",a=i,c="undefined",p=new v.default(-99999,-99999);let u=c;function f(){let e;if(u!==c){var t=figma.currentPage.children.length;if(1<t){t=figma.currentPage.children[t-1];if(t.id===u)return e=t,e}e=figma.currentPage.findOne(e=>e.id===u)}if((null==e||void 0===e)&&(e=figma.currentPage.findOne(e=>"1"===e.getPluginData(a)),null==e||void 0===e)){const n=figma.createFrame();n.locked=!0,n.setPluginData(a,"1"),e=figma.currentPage.findOne(e=>"1"===e.getPluginData(a)),d()}return u=e.id,e}function d(){const e=f();figma.currentPage.insertChild(figma.currentPage.children.length,e),e.resize(1,1),e.x=p.x,e.y=p.y,e.name=i,e.clipsContent=!1}t.GetPluginFrame=f;class h{constructor(e,t,n,o){console.assert(e<=1&&t<=1&&n<=1&&o<=1),this.r=e,this.g=t,this.b=n,this.a=o}}class b{constructor(){this.strokeCap=["NONE","ARROW_EQUILATERAL"],this.dashPattern=[],this.weight=1,this.color=new h(0,0,0,1),this.bezier=!0}}t.FlowSettings=b;t.FlowWorker=class{constructor(){var e=new Blob([document.getElementById("itemflow-worker").textContent]);this.worker=new Worker(window.URL.createObjectURL(e)),this.worker.addEventListener("message",this.onMessageFromWorker.bind(this),null)}onMessageFromWorker(e){}terminate(){this.worker.terminate()}};const w=new b;t.flowSettings=w;class y{constructor(){this.nodesAbsoluteTransform=[]}}function S(e){e=e.getPluginData(l);return 0===e.length?null:JSON.parse(e)}function P(e){e=e.getPluginData(s);return 0===e.length?[]:JSON.parse(e)}function O(n){const e=f().findChildren(e=>{const t=P(e);return 2===t.length&&void 0!==t.find(e=>e===n.id)});e.forEach(e=>e.remove())}function _(){return f().findChildren(e=>2===P(e).length)}function k(e){var t=S(e);!function(e,t,n){const o=JSON.parse(JSON.stringify(e.vectorNetwork));"strokeCap"in o.vertices[o.vertices.length-1]&&(o.vertices[o.vertices.length-1].strokeCap=t,o.vertices[0].strokeCap=n),e.vectorNetwork=o}(e,t.strokeCap[0],t.strokeCap[1]),e.dashPattern=t.dashPattern,e.strokeWeight=t.weight;const n=JSON.parse(JSON.stringify(e.strokes));n[0].color.r=t.color.r,n[0].color.g=t.color.g,n[0].color.b=t.color.b,n[0].opacity=t.color.a,e.strokes=n}function x(e,t,n,o){var r=t.absoluteTransform,i=n.absoluteTransform,a=new v.default(r[0][2],r[1][2]),s=new v.default(i[0][2],i[1][2]),l=0===(u=(u=e).getPluginData(m)).length?null:JSON.parse(u);let c=!0;if(null!==l&&(c=l.nodesAbsoluteTransform[0].x!==a.x||l.nodesAbsoluteTransform[0].y!==a.y||l.nodesAbsoluteTransform[1].x!==s.x||l.nodesAbsoluteTransform[1].y!==s.y),o||c){var r=g.default.GetClosestSnapPoints(t,n),i=r[0].x-r[1].x,u=r[0].y-r[1].y,l=r[0].x-i-p.x,o=r[0].y-u-p.y;if(e.x=l,e.y=o,S(e).bezier){const d=[0,0],h=[0,0];l=.5*u,o=.5*i;"right"!==r[0]._type&&"left"!==r[0]._type||(d[1]=o,h[1]=u),"top"!==r[0]._type&&"bottom"!==r[0]._type||(d[1]=i,h[1]=l),"right"!==r[1]._type&&"left"!==r[1]._type||(d[0]=o,h[0]=0),"top"!==r[1]._type&&"bottom"!==r[1]._type||(d[0]=0,h[0]=l),e.vectorPaths=[{windingRule:"EVENODD",data:`M 0 0 C ${d[0]} ${h[0]} ${d[1]} ${h[1]} ${i} ${u}`}]}else e.vectorPaths=[{windingRule:"EVENODD",data:`M 0 0 L ${i} ${u}`}];k(e);const f=new y;f.nodesAbsoluteTransform=[a,s],s=f,e.setPluginData(m,JSON.stringify(s)),e.name=`${t.name} -> ${n.name}`}}function M(e,t=!1){var n,o=P(e),r=figma.getNodeById(o[0]),i=figma.getNodeById(o[1]);null===r||null===i?e.remove():(n=r.removed,o=i.removed,n&&O(r),o&&O(i),o||n||x(e,r,i,t))}function F(e,t,n){let o=null;var r,i,a;o=(r=e,i=t,figma.currentPage.findOne(e=>{e=P(e);return 2===e.length&&(e[0]===r.id&&e[1]===i.id)})),null===o&&(o=figma.createVector(),f().appendChild(o)),a=o,n=n,a.setPluginData(l,JSON.stringify(n)),n=o,t=[e.id,t.id],n.setPluginData(s,JSON.stringify(t)),M(o,!0)}t.CreateFlow=F;let E=-1,I=-1,D=-1,C=!1,N=!1;const T=100,j=1e3/30;function A(e=50,t=!1){e<2*j&&(e=2*j),(t||N)&&(-1!==E&&clearInterval(E),E=setInterval(()=>{if(N){const r=_();if(0<r.length)for(let o=0;o<=r.length/T;o++)setTimeout(()=>{let e=o*T,t=e+T;e>=r.length&&(e=r.length-1),t>r.length&&(t=r.length);const n=r.slice(e,t);n.forEach(e=>{M(e)})},o*j)}},e))}function U(){C=!0,(0,r.SetOnSelectionChanged)(e=>{2===e.length&&F(e[0],e[1],w)}),(0,r.SetOnSelectionItemAdded)(e=>{e.id===f().id&&(figma.currentPage.selection=[])}),(0,r.SetOnSelectionItemRemoved)(e=>{null!==e&&e.removed&&O(e)})}function R(){(C=!1,r.SetOnSelectionChanged)(e=>{}),(0,r.SetOnSelectionItemAdded)(e=>{}),(0,r.SetOnSelectionItemRemoved)(e=>{})}function G(){N=!0,function(){const e=()=>{var e=_()["length"];return e+e/T*j};A(e(),!0),D=setInterval(()=>{N&&A(e())},1e4)}()}function J(){N=!1,-1!==D&&(clearInterval(D),D=-1),-1!==E&&(clearInterval(E),E=-1)}t.EnableFlowEvents=U,t.DisableFlowEvents=R,t.EnableFlowUpdate=G,t.DisableFlowUpdate=J,t.Enable=function(){I=setInterval(()=>{C&&d()},1e3),U(),G()},t.Disable=function(){void 0!==n.g.flowWorker&&n.g.flowWorker.terminate(),-1!==I&&(clearInterval(I),I=-1),R(),J()}},522:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UpdateSelection=t.GetSelection=t.SetOnSelectionItemRemoved=t.SetOnSelectionItemAdded=t.SetOnSelectionChanged=void 0;let r=[],n,i,a;function o(){const t=figma.currentPage["selection"];var e=r.length;const o=[];r.length>t.length?(r.forEach((n,e)=>{void 0!==t.find((e,t)=>n.id===e.id)&&o.push(n)}),o.forEach(e=>{i(e)}),r=o):r.length<t.length?t.forEach((n,e)=>{void 0!==r.find((e,t)=>n.id===e.id)||(r.push(n),a(n))}):t.length===r.length&&1===t.length&&t[0].id!==r[0].id&&(o.push(t[0]),a(t[0]),i(r[0]),r=o),1===e&&2===r.length&&n(r)}t.UpdateSelection=o,t.GetSelection=function(){return r},t.SetOnSelectionItemRemoved=function(e){i=e},t.SetOnSelectionItemAdded=function(e){a=e},t.SetOnSelectionChanged=function(e){n=e,figma.on("selectionchange",()=>{o()})}},634:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});class s extends o(n(464)).default{constructor(e,t,n){super(e,t),this._type=n}}function r(e,t){const n=new s(0,0,t);var o=e.rotation*(3.14/180),r=e.absoluteTransform[0][2],i=e.absoluteTransform[1][2];return"top"===t&&(n.x=r+.5*e.width*Math.cos(o),n.y=i-.5*e.width*Math.sin(o)),"right"===t&&(n.x=r+e.width*Math.cos(o)+.5*e.height*Math.sin(o),n.y=i+.5*e.height*Math.cos(o)-e.width*Math.sin(o)),"bottom"===t&&(n.x=r+.5*e.width*Math.cos(o)+e.height*Math.sin(o),n.y=i+e.height*Math.cos(o)-.5*e.width*Math.sin(o)),"left"===t&&(n.x=r+.5*e.height*Math.sin(o),n.y=i+.5*e.height*Math.cos(o)),n}function u(e){const t=[];var n=e.rotation*(3.14/180),o=e.absoluteTransform[0][2],r=e.absoluteTransform[1][2],i=Math.cos(n),a=Math.sin(n),{height:n,width:e}=e;return t.push(new s(o+.5*e*i,r-.5*e*a,"top")),t.push(new s(o+e*i+.5*n*a,r+.5*n*i-e*a,"right")),t.push(new s(o+.5*e*i+n*a,r+n*i-.5*e*a,"bottom")),t.push(new s(o+.5*n*a,r+.5*n*i,"left")),t}t.default={GetSnapPoint:r,GetSnapPointById:function(e,t){return r(e,0===t?"top":1===t?"right":2===t?"bottom":"left")},GetClosestSnapPoints:function(e,t){var n=u(e),o=[n[1],n[3]],r=[n[0],n[2]],i=u(t),a=[i[1],i[3]],e=[i[0],i[2]];const s=(n=function(t,n){const o=[null,null];let r=99999999;for(let e=0;e<2;e++){var i=(e+1)%2,a=t[e].dist(n[i]);a<r&&(o[0]=t[e],o[1]=n[i],r=a)}return[r,o]})(o,a);t=Math.abs(s[1][0].x-s[1][1].x),i=Math.abs(s[1][0].y-s[1][1].y),o=s[1][0].dist(s[1][1]);const l=n(r,e);a=Math.abs(l[1][0].x-l[1][1].x),n=Math.abs(l[1][0].y-l[1][1].y),r=l[1][0].dist(l[1][1]),Math.abs(l[1][0].x-s[1][1].x),Math.abs(l[1][0].y-s[1][1].y),e=l[1][0].dist(s[1][1]);let c=9999999;if(o<c&&(c=o),r<c&&(c=r),e<c&&(c=e),i<1.5*t){i=s[1][0],t=s[1][1];if("right"===i._type?i.x<t.x:i.x>t.x)return[s[1][0],s[1][1]]}return a<2*n?[l[1][0],l[1][1]]:[s[1][0],l[1][1]]}}},464:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(e,t){this.x=e,this.y=t}dist(e){var t=this.x-e.x,e=this.y-e.y;return Math.sqrt(t*t+e*e)}}}},o={};function r(e){var t=o[e];if(void 0!==t)return t.exports;t=o[e]={exports:{}};return n[e].call(t.exports,t,t.exports,r),t.exports}r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}();r(480)})();