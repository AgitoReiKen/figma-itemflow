(()=>{"use strict";var e={480:function(e,t,n){var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});const a=n(154),s=r(n(522)),l=r(n(154));figma.showUI(__html__),figma.ui.resize(300,330);const c=new l.FlowSettings;l.Enable(),s.SetOnSelectionChanged((e=>{2===e.length&&l.CreateFlow(e[0],e[1],c)})),figma.on("close",(()=>{l.Disable()})),figma.ui.onmessage=e=>{switch(console.log(e),e.type){case"set-stroke-weight":c.weight=parseInt(e.value,10);break;case"set-stroke-cap":null!==e.value[0]&&(c.strokeCap[0]=e.value[0]),null!==e.value[1]&&(c.strokeCap[1]=e.value[1]),console.log(c);break;case"set-color":{const t=function(e,t){return parseFloat((parseInt(t.substr(e,2),16)/255).toPrecision(3))};c.color.r=t(1,e.value),c.color.g=t(3,e.value),c.color.b=t(5,e.value);break}case"set-color-opacity":c.color.a=e.value;break;case"set-dash-pattern":c.dashPattern=[parseInt(e.value,10)];break;case"set-bezier":c.bezier=e.value;break;case"set-enabled":e.value?l.Enable():l.Disable();break;case"set-framelocked":(0,a.GetPluginFrame)().locked=e.value;break;case"cancel":figma.closePlugin()}}},154:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.CreateFlow=t.Disable=t.Enable=t.GetPluginFrame=t.FlowSettings=void 0;const i=n(522),r=o(n(634)),a=o(n(464)),s="ItemFrame",l=s,c="undefined",u=new a.default(-99999,-99999);let d=c;function h(){let e;if(e=d!==c?figma.currentPage.findOne((e=>e.id===d)):figma.currentPage.findOne((e=>"1"===e.getPluginData(l))),null===e){const t=figma.createFrame();t.resize(1,1),t.x=u.x,t.y=u.y,t.locked=!1,t.name=s,t.clipsContent=!1,t.setPluginData(l,"1"),e=figma.currentPage.findOne((e=>"1"===e.getPluginData(l))),d=e.id}else d=e.id;return e}t.GetPluginFrame=h;class f{constructor(e,t,n,o){console.assert(e<=1&&t<=1&&n<=1&&o<=1),this.r=e,this.g=t,this.b=n,this.a=o}}t.FlowSettings=class{constructor(){this.strokeCap=["NONE","ARROW_EQUILATERAL"],this.dashPattern=[],this.weight=1,this.color=new f(0,0,0,1),this.bezier=!0}};class g{constructor(){this.snapPoints=[]}}function p(e){const t=e.getPluginData("IFS");return 0!==t.length?JSON.parse(t):null}function v(e){const t=e.getPluginData("IF");return 0!==t.length?JSON.parse(t):[]}function m(e){h().findChildren((t=>{const n=v(t);return 2===n.length&&null!==n.find((t=>t===e.id))})).forEach((e=>e.remove()))}function y(e,t,n,o){const i=r.default.GetClosestSnapPoints(t,n),s=i[0].x-i[1].x,l=i[0].y-i[1].y,c=function(e){const t=e.getPluginData("IFC");return 0!==t.length?JSON.parse(t):null}(e);let d=!0;if(o||null===c||(d=c.snapPoints[0].x!==i[0].x||c.snapPoints[0].y!==i[0].y||c.snapPoints[1].x!==i[1].x||c.snapPoints[1].y!==i[1].y),d){const o=i[0].x-s-u.x,r=i[0].y-l-u.y;if(e.x=o,e.y=r,p(e).bezier){const t=[0,0],n=[0,0],o=.5*l,r=.5*s;"right"!==i[0]._type&&"left"!==i[0]._type||(t[1]=r,n[1]=l),"top"!==i[0]._type&&"bottom"!==i[0]._type||(t[1]=s,n[1]=o),"right"!==i[1]._type&&"left"!==i[1]._type||(t[0]=r,n[0]=0),"top"!==i[1]._type&&"bottom"!==i[1]._type||(t[0]=0,n[0]=o),e.vectorPaths=[{windingRule:"EVENODD",data:`M 0 0 C ${t[0]} ${n[0]} ${t[1]} ${n[1]} ${s} ${l}`}]}else e.vectorPaths=[{windingRule:"EVENODD",data:`M 0 0 L ${s} ${l}`}];!function(e){const t=p(e);!function(e,t,n){const o=JSON.parse(JSON.stringify(e.vectorNetwork));"strokeCap"in o.vertices[o.vertices.length-1]&&(o.vertices[o.vertices.length-1].strokeCap=t,o.vertices[0].strokeCap=n),e.vectorNetwork=o}(e,t.strokeCap[0],t.strokeCap[1]),e.dashPattern=t.dashPattern,e.strokeWeight=t.weight;const n=JSON.parse(JSON.stringify(e.strokes));n[0].color.r=t.color.r,n[0].color.g=t.color.g,n[0].color.b=t.color.b,n[0].opacity=t.color.a,e.strokes=n}(e);const c=new g;c.snapPoints=[new a.default(i[0].x,i[0].y),new a.default(i[1].x,i[1].y)],function(e,t){e.setPluginData("IFC",JSON.stringify(t))}(e,c),e.name=`${t.name} -> ${n.name}`}}function P(e,t=!1){const n=v(e),o=figma.getNodeById(n[0]),i=figma.getNodeById(n[1]);null===o||null===i?e.remove():(o.removed&&m(o),i.removed&&m(i),i.removed||o.removed||y(e,o,i,t))}t.CreateFlow=function(e,t,n){let o=null;var i,r;o=function(e,t){return figma.currentPage.findOne((n=>{const o=v(n);return 2===o.length&&o[0]===e.id&&o[1]===t.id}))}(e,t),null===o&&(o=figma.createVector(),h().appendChild(o)),function(e,t){e.setPluginData("IFS",JSON.stringify(t))}(o,n),i=o,r=[e.id,t.id],i.setPluginData("IF",JSON.stringify(r)),P(o,!0)};let b=-1,S=-1;t.Enable=function(){h().locked=!0,b=setInterval((()=>{h().findChildren((e=>2===v(e).length)).forEach((e=>{P(e)}))}),100),S=setInterval((()=>{figma.currentPage.insertChild(figma.currentPage.children.length,h())}),1e3),(0,i.SetOnSelectionItemAdded)((e=>{})),(0,i.SetOnSelectionItemRemoved)((e=>{e.removed&&m(e)}))},t.Disable=function(){-1!==b&&clearInterval(b),-1!==S&&clearInterval(S)}},522:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UpdateSelection=t.GetSelection=t.SetOnSelectionItemRemoved=t.SetOnSelectionItemAdded=t.SetOnSelectionChanged=void 0;let n,o,i,r=[];function a(){const{selection:e}=figma.currentPage,t=r.length,a=[];r.length>e.length?(r.forEach(((t,n)=>{void 0!==e.find(((e,n)=>t.id===e.id))&&a.push(t)})),a.forEach((e=>{o(e)})),r=a):r.length<e.length?e.forEach(((e,t)=>{void 0!==r.find(((t,n)=>e.id===t.id))||(r.push(e),i(e))})):e.length===r.length&&1===e.length&&e[0].id!==r[0].id&&(a.push(e[0]),i(e[0]),o(r[0]),r=a),1===t&&2===r.length&&n(r)}t.UpdateSelection=a,t.GetSelection=function(){return r},t.SetOnSelectionItemRemoved=function(e){o=e},t.SetOnSelectionItemAdded=function(e){i=e},t.SetOnSelectionChanged=function(e){n=e,figma.on("selectionchange",(()=>{a()}))}},634:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=o(n(464));class r extends i.default{constructor(e,t,n){super(e,t),this._type=n}}function a(e,t){const n=new r(0,0,t),o=e.rotation*(3.14/180);return"top"===t&&(n.x=e.x+.5*e.width*Math.cos(o),n.y=e.y-.5*e.width*Math.sin(o)),"right"===t&&(n.x=e.x+e.width*Math.cos(o)+.5*e.height*Math.sin(o),n.y=e.y+.5*e.height*Math.cos(o)-e.width*Math.sin(o)),"bottom"===t&&(n.x=e.x+.5*e.width*Math.cos(o)+e.height*Math.sin(o),n.y=e.y+e.height*Math.cos(o)-.5*e.width*Math.sin(o)),"left"===t&&(n.x=e.x+.5*e.height*Math.sin(o),n.y=e.y+.5*e.height*Math.cos(o)),n}function s(e,t){return a(e,0===t?"top":1===t?"right":2===t?"bottom":"left")}t.default={GetSnapPoint:a,GetSnapPointById:s,GetClosestSnapPoints:function(e,t){const n=[s(e,0),s(t,0)];let o=99999999;for(let i=0;i<4;i++){const r=s(e,i);for(let e=0;e<4;e++){const i=s(t,e),a=r.dist(i);a<o&&(n[0]=r,n[1]=i,o=a)}}return n}}},464:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(e,t){this.x=e,this.y=t}dist(e){const t=this.x-e.x,n=this.y-e.y;return Math.sqrt(t*t+n*n)}}}},t={};!function n(o){var i=t[o];if(void 0!==i)return i.exports;var r=t[o]={exports:{}};return e[o].call(r.exports,r,r.exports,n),r.exports}(480)})();